<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.dreamstart.mapper.SurveyMapper">
	<!-- 응답 결과 -->
	<resultMap type="SurveyAnswerDTO" id="answerMap">
		<id column="answer_id" property="answerId" />
		<result column="response_id" property="responseId" />
		<result column="question_id" property="questionId" />
		<result column="option_id" property="optionId" />
		<result column="answer_text" property="answerText" />
	</resultMap>
	
	<!-- 설문조사 메타 (제목, 설명, 익명여부 등) -->
	<resultMap type="SurveyDTO" id="surveyMap">
		<id column="survey_id" property="surveyId" />
		<result column="event_id" property="eventId" />
		<result column="title" property="title" />
		<result column="description" property="description" />
		<result column="status" property="status" />
		<result column="is_anonymous" property="isAnonymous" />
		<result column="clone_from_survey_id" property="cloneFromSurveyId" />
		<result column="open_at" property="openAt" />
		<result column="close_at" property="closeAt" />
		<result column="created_by" property="createdBy" />
		<result column="created_at" property="createdAt" />
		<result column="update_at" property="updateAt" />
		<result column="is_template" property="isTemplate" />
		<result column="template_key" property="templateKey" />
	</resultMap>

	<!-- 객관식 보기 -->
	<resultMap type="SurveyOptionDTO" id="optionMap">
		<id column="option_id" property="optionId" />
		<result column="question_id" property="questionId" />
		<result column="label" property="label" />
		<result column="opt_value" property="optValue" />
	</resultMap>
	
	<!-- 문항 리스트 -->
	<resultMap type="SurveyQuestionDTO" id="questionMap">
		<id column="question_id" property="questionId" />
		<result column="survey_id" property="surveyId" />
		<result column="question" property="question" />
		<result column="type" property="type" />
	</resultMap>

	<!-- 응답 이력 -->
	<resultMap type="SurveyResponseDTO" id="responseMap">
		<id column="response_id" property="responseId" />
		<result column="survey_id" property="surveyId" />
		<result column="user_id" property="userId" />
		<result column="responded_at" property="respondedAt" />
	</resultMap>
	
	
	<!-- select -->
	<select id="surveyPage" resultMap="surveyMap">
		select survey_id, event_id, title, description, status, is_anonymous, clone_from_survey_id, open_at, close_at, created_by, created_at, update_at, is_template, template_key
		from survey
	</select>
	
	<!-- insert -->
	<insert id="insertSurvey" parameterType="SurveyDTO">
		
	</insert>
	
	
	
	
	
	
	
	<!-- 테스트용 조회 -->
	<!-- 설문템플릿 -->
	<select id="surveyAll" resultMap="surveyMap">
		select * from `survey` limit 3
	</select>
	
	<!-- 응답결과 -->
	<select id="answerAll" resultMap="answerMap">
		select * from `survey_answer` limit 3
	</select>
	
	<!-- 보기 -->
	<select id="optionAll" resultMap="optionMap">
		select * from `survey_option` limit 3
	</select>
	
	<!-- 문항 -->
	<select id="questionAll" resultMap="questionMap">
		select * from `survey_question` limit 3
	</select>
	
	<!-- 응답이력 -->
	<select id="responseAll" resultMap="responseMap">
		select * from `survey_response` limit 3
	</select>
		
</mapper>
